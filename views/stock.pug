//http://html2pug.com/
doctype html
html
  - var title = symbol
  - var username = user.name.givenName
  include includes/head.pug
  script(type='text/javascript', src='https://www.gstatic.com/charts/loader.js')
  script(src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js")
  script(src='/largeChart.js')
  script!='var g_symbol = "' + symbol + '";' 
  
  script.
      google.charts.load('current', {'packages':['line']});
      google.charts.setOnLoadCallback(drawThis);
      function drawThis(){
      $('.demo-charts').hide();
      if($('#1day').is(":checked")){
        console.log($('#1day').is(":checked"));
        $(".oneday").show();
      }
      if($('#5day').is(":checked")){
        $(".fiveday").show();
      }
      if($('#1month').is(":checked")){
        $(".onemonth").show();
      }
      if($('#3month').is(":checked")){
        $(".threemonth").show();
      }
      if($('#6month').is(":checked")){
        $(".sixmonth").show();
      }
      drawChart(google, g_symbol, '1d', '1d', '#1day');
      drawChart(google, g_symbol, '5d', '5d', '#5day');
      drawChart(google, g_symbol, '1m', '1m', '#1month');
      drawChart(google, g_symbol, '3m', '3m', '#3month');
      drawChart(google, g_symbol, '6m', '6m', '#6month');
      }

  body
    .demo-layout.mdl-layout.mdl-js-layout.mdl-layout--fixed-drawer.mdl-layout--fixed-header
      include includes/headernav.pug
      main.mdl-layout__content.mdl-color--grey-100
        #searchresults.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--6-offset.mdl-cell--3-col.mdl-grid(style='position:fixed; z-index:-1')
        .mdl-grid.demo-content
          .demo-options.mdl-card.mdl-color--deep-purple-500.mdl-shadow--2dp.mdl-cell.mdl-cell--4-col.mdl-cell--3-col-tablet.mdl-cell--12-col-desktop
            .mdl-card__supporting-text.mdl-color-text--blue-grey-50
              h4 View options
              ul
                li
                  label.mdl-checkbox.mdl-js-checkbox.mdl-js-ripple-effect(for='1day')
                    input#1day.mdl-checkbox__input(type='checkbox' checked)
                    |  
                    span.mdl-checkbox__label 1 day
                li
                  label.mdl-checkbox.mdl-js-checkbox.mdl-js-ripple-effect(for='5day')
                    input#5day.mdl-checkbox__input(type='checkbox' )
                    |  
                    span.mdl-checkbox__label 5 day
                li
                  label.mdl-checkbox.mdl-js-checkbox.mdl-js-ripple-effect(for='1month')
                    input#1month.mdl-checkbox__input(type='checkbox')
                    |  
                    span.mdl-checkbox__label 1 month
                li
                  label.mdl-checkbox.mdl-js-checkbox.mdl-js-ripple-effect(for='3month')
                    input#3month.mdl-checkbox__input(type='checkbox' )
                    |  
                    span.mdl-checkbox__label 3 month
                li
                  label.mdl-checkbox.mdl-js-checkbox.mdl-js-ripple-effect(for='6month')
                    input#6month.mdl-checkbox__input(type='checkbox' checked)
                    |  
                    span.mdl-checkbox__label 6 month
          
        .mdl-grid.demo-content
          .demo-charts.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--12-col.mdl-grid.oneday
            #1d(style="width:80vw")
          .demo-charts.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--12-col.mdl-grid.fiveday
            #5d(style="width:80vw")
          .demo-charts.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--12-col.mdl-grid.onemonth
            #1m(style="width:80vw")
          .demo-charts.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--12-col.mdl-grid.threemonth
            #3m(style="width:80vw")
          .demo-charts.mdl-color--white.mdl-shadow--2dp.mdl-cell.mdl-cell--12-col.mdl-grid.sixmonth
            #6m(style="width:80vw")
          .mdl-shadow--2dp.mdl-color--white.mdl-cell.mdl-cell--8-col
            .here
              
            
            script.
              console.log('#{exchange}:#{symbol}');
              $.get('https://tr-finance.gomix.me/stocks/alt/news/#{exchange}:#{symbol}', function(news){
                function template(date, title, summary, link){
                  var aDiv = $('<div>').addClass(".mdl-shadow--2dp.mdl-color--white.mdl-cell.mdl-cell--8-col")
                  .html(
                  `
                    <div style='padding: 20px' class='.mdl-cell.mdl-cell--12-col'>
                      <h3 data-date="${date}">${title}<h3>
                      <p>${summary}<p>
                      <a target="_blank" href='${link}'class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" 
                      style="color:white; background:'blue'">Go To Article</a>
                    </div>
                  </div>
                  `);
                  return aDiv;
                }
              
                console.log(news);
                news = news.feed.entries;
                for (var i=0; i < news.length; i++){
                var article = news[i];
                 template(article.pubDate,article.title,article.contentSnippet,article.link).appendTo('.here');
                 if (i !== news.length - 1){
                   $('<hr>').appendTo('.here');
                 }
                }
              });
          .demo-cards.mdl-cell.mdl-cell--4-col.mdl-cell--8-col-tablet.mdl-grid.mdl-grid--no-spacing
            .demo-updates.mdl-card.mdl-shadow--2dp.mdl-cell.mdl-cell--4-col.mdl-cell--4-col-tablet.mdl-cell--12-col-desktop
              .mdl-card__title.mdl-card--expand.mdl-color--teal-300
                h2.mdl-card__title-text Updates
              .mdl-card__supporting-text.mdl-color-text--grey-600  Non dolore elit adipisicing ea reprehenderit consectetur culpa.
              .mdl-card__actions.mdl-card--border
                a.mdl-button.mdl-js-button.mdl-js-ripple-effect(href='#') Read More
            .demo-separator.mdl-cell--1-col
    
    include includes/usersettings.pug
    
    script.
      $('#1day').click(function() {
        $(".oneday").toggle();
        $("#1day").toggle(this.checked);
      });
      $('#5day').click(function() {
        $(".fiveday").toggle();
        $("#5day").toggle(this.checked);
      });
      $('#1month').click(function() {
        $(".onemonth").toggle();
        $('#1month').toggle(this.checked);
      });
      $('#3month').click(function() {
        $(".threemonth").toggle();
        $('#3month').toggle(this.checked);
      });
      $('#6month').click(function() {
        $(".sixmonth").toggle();
        $('#6month').toggle(this.checked);
      });
    
    script(src='https://code.getmdl.io/1.3.0/material.min.js')
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.js', integrity='sha256-1qeNeAAFNi/g6PFChfXQfa6CQ8eXoHXreohinZsoJOQ=', crossorigin='anonymous')
    script(src='/client.js')
